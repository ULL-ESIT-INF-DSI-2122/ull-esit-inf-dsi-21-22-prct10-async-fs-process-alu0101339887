<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101339887</title><meta name="description" content="Documentation for ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101339887"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101339887</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1> ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101339887 </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography"><br>

<p><a href="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101339887/actions/workflows/tests.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101339887/actions/workflows/tests.yml/badge.svg" alt="Tests"></a>
<a href="https://coveralls.io/github/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101339887?branch=main"><img src="https://coveralls.io/repos/github/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101339887/badge.svg?branch=main" alt="Coverage Status"></a>
<a href="https://sonarcloud.io/summary/new_code?id=ULL-ESIT-INF-DSI-2122_ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101339887"><img src="https://sonarcloud.io/api/project_badges/measure?project=ULL-ESIT-INF-DSI-2122_ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101339887&metric=alert_status" alt="Quality Gate Status"></a></p>

<a href="#índice" id="índice" style="color: inherit; text-decoration: none;">
  <h1>ÍNDICE</h1>
</a>
<ul>
<li><a href="#id1">INTRODUCCIÓN</a>.</li>
<li><a href="#id2">DESARROLLO</a>.<ul>
<li><a href="#id3">Ejercicio 1</a>.</li>
<li><a href="#id4">Ejercicio 2</a>.<ul>
<li><a href="#id5">Manejo de los argumentos</a>.</li>
<li><a href="#id6">Método <code>withPipe()</code></a>.</li>
<li><a href="#id7">Método <code>withoutPipe()</code></a>.</li>
<li><a href="#id8">Ejemplos de ejecución</a>.</li>
</ul>
</li>
<li><a href="#id9">Ejercicio 3</a>.<ul>
<li><a href="#id10">Manejo de los argumentos</a>.</li>
<li><a href="#id11">Método <code>watchFile_()</code></a>.</li>
<li><a href="#id12">Método <code>watchAll()</code></a>.</li>
<li><a href="#id13">Método <code>getUser()</code></a>.</li>
<li><a href="#id14">Método <code>readFile_()</code></a>.</li>
<li><a href="#id15">Ejemplos de ejecución</a>.</li>
</ul>
</li>
<li><a href="#id16">Ejercicio 4</a>.<ul>
<li><a href="#id17">Manejo de los argumentos</a>.</li>
<li><a href="#id18">Método <code>type_()</code></a>.</li>
<li><a href="#id19">Método <code>isDirectory()</code></a>.</li>
<li><a href="#id20">Método <code>add()</code></a>.</li>
<li><a href="#id21">Método <code>list()</code></a>.</li>
<li><a href="#id22">Método <code>showFile_()</code></a>.</li>
<li><a href="#id23">Método <code>remove()</code></a>.</li>
<li><a href="#id24">Método <code>moveDir()</code></a>.</li>
<li><a href="#id25">Ejemplos de ejecución</a>.</li>
</ul>
</li>
</ul>
</li>
<li><a href="#id26">CONCLUSIÓN</a>.</li>
</ul>

<a href="#introdicción" id="introdicción" style="color: inherit; text-decoration: none;">
  <h1>INTRODICCIÓN<a name="id1"></a></h1>
</a>
<p>En esta práctica resolveremos distintos ejercicios centrándonos, sobretodo, en el uso de <strong>callbacks</strong> y <strong>funciones asíncronas</strong>. Para ello haremos uso de algunas de las funciones proporcionadas por <code>fs</code>, <code>spawn</code> y <code>chokidar</code> (se utilizará para comprobar su funcionamiento respecto al de fs). Por otra parte, también tendremos que hacer uso de yargs para poder utilizar la entrada de comandos del usuario por la terminal para poder ejecutar cada uno de los programas. </p>
<p>Al igual que en prácticas anteriores, tendremos que realizar un conjunto de ejercicios que podremos encontrarlos dentro de los directorios <em>/Ejercicio-01</em>, <em>/Ejercicio-02</em>, <em>/Ejercicio-03</em> y <em>Ejercicio-04</em> que, a su vez, estarán ubicados dentro de los directorios <strong>/src/Ejercicios_P10</strong>. Dentro del directorio <strong>/src</strong> también podremos encontrarnos con los siguientes directorios:</p>
<ul>
<li><strong>EjercicioLAB:</strong> Contiene los ejercicios de la práctica de laboratorio.</li>
<li><strong>EjercicioPrueba:</strong> Contiene ejercicios de prueba para el funcionamiento de las GitHub Actions en la configuración inicial del repositorio.</li>
<li><strong>P09_Notas:</strong> Contiene la API de la práctica 9 para poder usarla en el ejercicio 3 de esta práctica.</li>
</ul>
<p>Por otro lado, también se creará la documentación, de forma automática, de todos los ejercicios que hayamos realizado haciendo uso de TypeDoc. Podremos consultar la documentación pulsando sobre el siguiente <a href="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101339887/tree/main/docs"><em>enlace</em></a> que le llevará al directorio o accediendo manualmente al directorio <strong>/docs</strong>. </p>
<p>Además, para poder acceder a los tests de cada ejercicio podrá hacerlo pulsando sobre el siguiente <a href="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101339887/tree/main/test"><em>enlace</em></a> que le llevará al directorio correspondiente o accediendo manualmente al directorio <strong>/test</strong>.</p>
<p>Por último, podrá acceder a la página web del informe pulsando sobre este <a href="https://ull-esit-inf-dsi-2122.github.io/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101339887/"><em>enlace</em></a>.</p>

<a href="#desarollo" id="desarollo" style="color: inherit; text-decoration: none;">
  <h1>DESAROLLO<a name="id2"></a></h1>
</a>

<a href="#ejercicio-1" id="ejercicio-1" style="color: inherit; text-decoration: none;">
  <h2>Ejercicio 1<a name="id3"></a></h2>
</a>

<a href="#ejercicio-2" id="ejercicio-2" style="color: inherit; text-decoration: none;">
  <h2>Ejercicio 2<a name="id4"></a></h2>
</a>
<p>Para este segundo ejercicio se nos pide implementar un programa que devuelva el número de ocurrencias de una palabra en un fichero de texto. Para ello deberemos hacer uso de la función <strong>spawn</strong> y de los comandos <code>grep</code>, <code>cat</code> y <code>wc</code>. Además, gracias al uso del paquete <strong>yargs</strong> podremos acceder y gestionar los parámetros introducidos por el usuario desde la línea de comandos.</p>
<p><strong>[IMAGEN]</strong></p>

<a href="#manejo-de-los-argumentos" id="manejo-de-los-argumentos" style="color: inherit; text-decoration: none;">
  <h3>Manejo de los argumentos<a name="id5"></a></h3>
</a>
<p>Como comentamos anteriormente, para poder acceder a los argumentos introducidos por el usuario desde la línea de comandos, se utilizará el paquete <strong>yargs</strong>.</p>
<pre><code class="language-typescript"><span class="hl-0">yargs</span><span class="hl-1">.</span><span class="hl-2">command</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">command:</span><span class="hl-1"> </span><span class="hl-3">&#39;count&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Counts the number of word occurrences in a file&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">builder:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">file:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;File to count&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">demandOption:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">word:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Word to count&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">demandOption:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">pipe:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Function to use&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">demandOption:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">handler</span><span class="hl-0">:</span><span class="hl-1"> (</span><span class="hl-0">argv</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// here goes the code to execute</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code></pre>
<p>Dentro del handler de la línea de comandos, se realizará una llamada a la función withPipe() o withouPipe() dependiendo de cómo se haya especificado el parámetro <code>--pipe=</code>.</p>
<pre><code class="language-typescript"><span class="hl-0">yargs</span><span class="hl-1">.</span><span class="hl-2">command</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-5">// here goes the code to execute</span><br/><span class="hl-1">  </span><span class="hl-2">handler</span><span class="hl-0">:</span><span class="hl-1"> (</span><span class="hl-0">argv</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> {</span><span class="hl-6">file</span><span class="hl-1">, </span><span class="hl-6">word</span><span class="hl-1">, </span><span class="hl-6">pipe</span><span class="hl-1">} = </span><span class="hl-0">argv</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">pipe</span><span class="hl-1"> === </span><span class="hl-3">&#39;yes&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">withPipe</span><span class="hl-1">(</span><span class="hl-0">file</span><span class="hl-1"> </span><span class="hl-7">as</span><span class="hl-1"> </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-0">word</span><span class="hl-1"> </span><span class="hl-7">as</span><span class="hl-1"> </span><span class="hl-8">string</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">pipe</span><span class="hl-1"> === </span><span class="hl-3">&#39;no&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">withoutPipe</span><span class="hl-1">(</span><span class="hl-0">file</span><span class="hl-1"> </span><span class="hl-7">as</span><span class="hl-1"> </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-0">word</span><span class="hl-1"> </span><span class="hl-7">as</span><span class="hl-1"> </span><span class="hl-8">string</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Invalid function&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code></pre>

<a href="#método-withpipe" id="método-withpipe" style="color: inherit; text-decoration: none;">
  <h3>Método <code>withPipe()</code><a name="id6"></a></h3>
</a>
<p>Con esta función se podrá contar el número de ocurrencias de una palabra en un fichero de texto haciendo uso del método pipe de la función <strong>spawn</strong>. </p>
<pre><code class="language-typescript"><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-2">withPipe</span><span class="hl-1">(</span><span class="hl-0">file</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-0">word</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">access</span><span class="hl-1">(</span><span class="hl-0">file</span><span class="hl-1">, (</span><span class="hl-0">err</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-4">${</span><span class="hl-0">file</span><span class="hl-4">}</span><span class="hl-3"> not found`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">grepChild</span><span class="hl-1"> = </span><span class="hl-2">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;grep&#39;</span><span class="hl-1">, [</span><span class="hl-3">&#39;-o&#39;</span><span class="hl-1">, </span><span class="hl-0">word</span><span class="hl-1">, </span><span class="hl-0">file</span><span class="hl-1">]);</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">wcChild</span><span class="hl-1"> = </span><span class="hl-2">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;wc&#39;</span><span class="hl-1">, [</span><span class="hl-3">&#39;-l&#39;</span><span class="hl-1">]);</span><br/><span class="hl-1">      </span><span class="hl-0">grepChild</span><span class="hl-1">.</span><span class="hl-0">stdout</span><span class="hl-1">.</span><span class="hl-2">pipe</span><span class="hl-1">(</span><span class="hl-0">wcChild</span><span class="hl-1">.</span><span class="hl-0">stdin</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-0">wcChild</span><span class="hl-1">.</span><span class="hl-0">stdout</span><span class="hl-1">.</span><span class="hl-2">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-0">data</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">counter</span><span class="hl-1"> = </span><span class="hl-0">data</span><span class="hl-1">.</span><span class="hl-2">toString</span><span class="hl-1">().</span><span class="hl-2">trim</span><span class="hl-1">();</span><br/><span class="hl-1">        </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">word</span><span class="hl-4">}</span><span class="hl-3"> appears </span><span class="hl-4">${</span><span class="hl-0">counter</span><span class="hl-4">}</span><span class="hl-3"> times in </span><span class="hl-4">${</span><span class="hl-0">file</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#método-withoutpipe" id="método-withoutpipe" style="color: inherit; text-decoration: none;">
  <h3>Método <code>withoutPipe()</code><a name="id7"></a></h3>
</a>
<p>Con esta función se podrá contar el número de ocurrencias de una palabra en un fichero de texto sin hacer uso del método pipe de la función <strong>spawn</strong>. </p>
<pre><code class="language-typescript"><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-2">withoutPipe</span><span class="hl-1">(</span><span class="hl-0">file</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-0">word</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">access</span><span class="hl-1">(</span><span class="hl-0">file</span><span class="hl-1">, (</span><span class="hl-0">err</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-4">${</span><span class="hl-0">file</span><span class="hl-4">}</span><span class="hl-3"> not found`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">child</span><span class="hl-1"> = </span><span class="hl-2">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;grep&#39;</span><span class="hl-1">, [</span><span class="hl-3">&#39;-o&#39;</span><span class="hl-1">, </span><span class="hl-0">word</span><span class="hl-1">, </span><span class="hl-0">file</span><span class="hl-1">]);</span><br/><span class="hl-1">      </span><span class="hl-0">child</span><span class="hl-1">.</span><span class="hl-0">stdout</span><span class="hl-1">.</span><span class="hl-2">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-0">data</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">counter</span><span class="hl-1"> = </span><span class="hl-0">data</span><span class="hl-1">.</span><span class="hl-2">toString</span><span class="hl-1">().</span><span class="hl-2">split</span><span class="hl-1">(</span><span class="hl-3">&#39;</span><span class="hl-9">\n</span><span class="hl-3">&#39;</span><span class="hl-1">).</span><span class="hl-0">length</span><span class="hl-1"> - </span><span class="hl-10">1</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">word</span><span class="hl-4">}</span><span class="hl-3"> appears </span><span class="hl-4">${</span><span class="hl-0">counter</span><span class="hl-4">}</span><span class="hl-3"> times in </span><span class="hl-4">${</span><span class="hl-0">file</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>
<blockquote>
<blockquote>
<p>En caso de que el fichero no exista, se mostrará un mensaje de error, sin embargo, si el fichero existe, se mostrará el número de ocurrencias de la palabra.</p>
</blockquote>
</blockquote>
<p><strong>[IMAGEN]</strong></p>

<a href="#ejemplos-de-ejecución" id="ejemplos-de-ejecución" style="color: inherit; text-decoration: none;">
  <h3>Ejemplos de ejecución<a name="id8"></a></h3>
</a>
<pre><code class="language-bash"><span class="hl-1">$ node count.js count --file=file.txt --word=word --pipe=yes</span><br/><span class="hl-1">$ node count.js count --file=file.txt --word=word --pipe=no</span>
</code></pre>

<a href="#ejercicio-3" id="ejercicio-3" style="color: inherit; text-decoration: none;">
  <h2>Ejercicio 3<a name="id9"></a></h2>
</a>
<p>En este tercer ejercicio se tendrá que crear un programa que controle los cambios realizados sobre todo el directorio especificado en la línea de comandos por el usuario al mismo tiempo que dicho usuario interactúa con la aplicación de procesamiento de notas creada en la práctica anterior (<a href="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct09-filesystem-notes-app-alu0101339887"><em>Práctica_09</em></a>).</p>
<p>Para ello, el nuevo programa deberá recibir desde la línea de comandos tanto el nombre de un usuario de la aplicación de notas, así como la ruta donde se almacenan las notas de dicho usuario. Esto puede gestionarse nuevamente haciendo uso del paquete <code>yargs</code>.</p>

<a href="#manejo-de-los-argumentos-1" id="manejo-de-los-argumentos-1" style="color: inherit; text-decoration: none;">
  <h3>Manejo de los argumentos<a name="id10"></a></h3>
</a>
<p>Como comentamos anteriormente, para poder acceder a los argumentos introducidos por el usuario desde la línea de comandos, se utilizará el paquete <strong>yargs</strong>.</p>
<p>En este caso, se crearán dos comandos:</p>
<ul>
<li><p><code>watch</code>: Para controlar los cambios realizados en el directorio especificado por el usuario.</p>
<pre><code class="language-typescript"><span class="hl-0">yargs</span><span class="hl-1">.</span><span class="hl-2">command</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">command:</span><span class="hl-1"> </span><span class="hl-3">&#39;watch&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Control de cambios sobre un directorio&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">builder:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">user:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Usuario&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">demandOption:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">path:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Ruta del directorio&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">demandOption:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">handler</span><span class="hl-0">:</span><span class="hl-1"> (</span><span class="hl-0">argv</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-4">typeof</span><span class="hl-1"> </span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">user</span><span class="hl-1"> !== </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1"> || </span><span class="hl-4">typeof</span><span class="hl-1"> </span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1"> !== </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Invalid user or path&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">watchFile_</span><span class="hl-1">(</span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">user</span><span class="hl-1">, </span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code></pre>
</li>
<li><p><code>watchAll</code>: Para controlar los cambios realizados en los directorios de todos los usuarios.</p>
<pre><code class="language-typescript"><span class="hl-0">yargs</span><span class="hl-1">.</span><span class="hl-2">command</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">command:</span><span class="hl-1"> </span><span class="hl-3">&#39;watchAll&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Control de cambios sobre un directorio&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">builder:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">path:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Ruta del directorio&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">demandOption:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">handler</span><span class="hl-0">:</span><span class="hl-1"> (</span><span class="hl-0">argv</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-4">typeof</span><span class="hl-1"> </span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1"> !== </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Invalid path&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">watchAll</span><span class="hl-1">(</span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code></pre>
</li>
</ul>

<a href="#método-watchfile_" id="método-watchfile_" style="color: inherit; text-decoration: none;">
  <h3>Método <code>watchFile_()</code><a name="id11"></a></h3>
</a>
<p>Este método se encargará de controlar los cambios realizados en un fichero especificado por el usuario. En esta función es interesante comentar que, dependiendo del paquete que usemos, podremos especificar más o menos los eventos que suceden a la hora de realizar cambios en un directorio o en un fichero.</p>
<p>Por ejemplo, si realizamos la función haciendo uso del paquete <strong>fs</strong>, solo podemos observar dos eventos a la hora de realizar los cambios:</p>
<ul>
<li><code>change</code>: Cuando se realiza un cambio en el fichero.</li>
<li><code>rename</code>: Cuando se renombra, se añade o se elimina un fichero.</li>
</ul>
<pre><code class="language-typescript"><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-2">watchFile_</span><span class="hl-1">(</span><span class="hl-0">user</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-0">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">watch</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">, (</span><span class="hl-0">event</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-0">filename</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">file</span><span class="hl-1"> = </span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">path</span><span class="hl-4">}</span><span class="hl-3">/</span><span class="hl-4">${</span><span class="hl-0">filename</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">event</span><span class="hl-1"> === </span><span class="hl-3">&#39;rename&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">user</span><span class="hl-4">}</span><span class="hl-3"> renamed </span><span class="hl-4">${</span><span class="hl-0">filename</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-2">readFile_</span><span class="hl-1">(</span><span class="hl-0">file</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">event</span><span class="hl-1"> === </span><span class="hl-3">&#39;change&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">user</span><span class="hl-4">}</span><span class="hl-3"> changed </span><span class="hl-4">${</span><span class="hl-0">filename</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-2">readFile_</span><span class="hl-1">(</span><span class="hl-0">file</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>
<p>Por otro lado, si hacemos uso de <strong>chokidar</strong>, podemos observar los eventos que suceden a la hora de realizar los cambios en un directorio o en un fichero de una forma más específica, ya que podemos observar tres eventos distintos:</p>
<ul>
<li><code>add</code>: Cuando se añade un fichero.</li>
<li><code>change</code>: Cuando se añade un directorio.</li>
<li><code>unlink</code>: Cuando se elimina un fichero.</li>
</ul>
<p>Sin embargo, a la hora de renombrar un archivo, nos aparecerán dos eventos, add y unlink, ya que al renombrar un fichero en específico, se &quot;eliminará&quot; el fichero original y se &quot;creará&quot; uno con el nuevo nombre.</p>
<pre><code class="language-typescript"><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-2">watchFile_</span><span class="hl-1">(</span><span class="hl-0">user</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-0">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">watcher</span><span class="hl-1"> = </span><span class="hl-2">watch</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-0">watcher</span><span class="hl-1">.</span><span class="hl-2">on</span><span class="hl-1">(</span><span class="hl-3">&#39;add&#39;</span><span class="hl-1">, (</span><span class="hl-0">path</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">user</span><span class="hl-4">}</span><span class="hl-3"> added </span><span class="hl-4">${</span><span class="hl-0">path</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">readFile_</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-0">watcher</span><span class="hl-1">.</span><span class="hl-2">on</span><span class="hl-1">(</span><span class="hl-3">&#39;change&#39;</span><span class="hl-1">, (</span><span class="hl-0">path</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">user</span><span class="hl-4">}</span><span class="hl-3"> changed </span><span class="hl-4">${</span><span class="hl-0">path</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">readFile_</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-0">watcher</span><span class="hl-1">.</span><span class="hl-2">on</span><span class="hl-1">(</span><span class="hl-3">&#39;unlink&#39;</span><span class="hl-1">, (</span><span class="hl-0">path</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">user</span><span class="hl-4">}</span><span class="hl-3"> removed </span><span class="hl-4">${</span><span class="hl-0">path</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-0">watcher</span><span class="hl-1">.</span><span class="hl-2">on</span><span class="hl-1">(</span><span class="hl-3">&#39;error&#39;</span><span class="hl-1">, (</span><span class="hl-0">error</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">user</span><span class="hl-4">}</span><span class="hl-3"> error </span><span class="hl-4">${</span><span class="hl-0">error</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#método-watchall" id="método-watchall" style="color: inherit; text-decoration: none;">
  <h3>Método <code>watchAll()</code><a name="id12"></a></h3>
</a>
<p>En el caso de la función <code>watchAll()</code>, se encargará de controlar los cambios realizados en todos los directorios de todos los usuarios. Al igual que en la función anterior, también es interesante comentar que, dependiendo del paquete que usemos, podremos especificar más o menos los eventos que suceden a la hora de realizar cambios en un directorio o en un fichero.</p>
<p>Por otro lado, al contrario que la anterior, en esta tendremos que obtener el nombre de cada usuario haciendo uso de la función <code>getUser()</code> para poder especificar en la terminal en qué directorio se entán realizando los cambios.</p>
<pre><code class="language-typescript"><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-2">watchAll</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">user</span><span class="hl-1"> = </span><span class="hl-2">getUser</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-2">watch</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">, (</span><span class="hl-0">event</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-0">filename</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">// here go the code </span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#método-getuser" id="método-getuser" style="color: inherit; text-decoration: none;">
  <h3>Método <code>getUser()</code><a name="id13"></a></h3>
</a>
<p>Este método se encargará de obtener el nombre del usuario que está realizando los cambios en un directorio especificado por el usuario.</p>
<pre><code class="language-typescript"><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-2">getUser</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">user</span><span class="hl-1"> = </span><span class="hl-0">path</span><span class="hl-1">.</span><span class="hl-2">split</span><span class="hl-1">(</span><span class="hl-3">&#39;/&#39;</span><span class="hl-1">)[</span><span class="hl-10">3</span><span class="hl-1">];</span><br/><span class="hl-1">  </span><span class="hl-7">return</span><span class="hl-1"> </span><span class="hl-0">user</span><span class="hl-1">;</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#método-readfile_" id="método-readfile_" style="color: inherit; text-decoration: none;">
  <h3>Método <code>readFile_()</code><a name="id14"></a></h3>
</a>
<p>Este método se encargará de leer el fichero especificado por el usuario y de mostrarlo por pantalla cada vez que se produzca un cambio en él.</p>
<pre><code class="language-typescript"><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-2">readFile_</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`Reading file </span><span class="hl-4">${</span><span class="hl-0">path</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-2">open</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">, </span><span class="hl-3">&#39;r&#39;</span><span class="hl-1">, (</span><span class="hl-0">err</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`Error opening </span><span class="hl-4">${</span><span class="hl-0">path</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-0">data</span><span class="hl-1"> = </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">lineReader</span><span class="hl-1"> = </span><span class="hl-2">require</span><span class="hl-1">(</span><span class="hl-3">&#39;readline&#39;</span><span class="hl-1">).</span><span class="hl-2">createInterface</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-0">input:</span><span class="hl-1"> </span><span class="hl-2">require</span><span class="hl-1">(</span><span class="hl-3">&#39;fs&#39;</span><span class="hl-1">).</span><span class="hl-2">createReadStream</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">),</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-0">lineReader</span><span class="hl-1">.</span><span class="hl-2">on</span><span class="hl-1">(</span><span class="hl-3">&#39;line&#39;</span><span class="hl-1">, (</span><span class="hl-0">line</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">data</span><span class="hl-1"> += </span><span class="hl-0">line</span><span class="hl-1">;</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-0">lineReader</span><span class="hl-1">.</span><span class="hl-2">on</span><span class="hl-1">(</span><span class="hl-3">&#39;close&#39;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">` --&gt; Content of </span><span class="hl-4">${</span><span class="hl-0">path</span><span class="hl-4">}</span><span class="hl-3">: </span><span class="hl-4">${</span><span class="hl-0">data</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#ejemplos-de-ejecución-1" id="ejemplos-de-ejecución-1" style="color: inherit; text-decoration: none;">
  <h3>Ejemplos de ejecución<a name="id15"></a></h3>
</a>
<pre><code class="language-bash"><span class="hl-1">$ node watch.js watch --user=user --path=path</span><br/><span class="hl-1">$ node watch.js watchAll --path=path</span>
</code></pre>

<a href="#ejercicio-4" id="ejercicio-4" style="color: inherit; text-decoration: none;">
  <h2>Ejercicio 4<a name="id16"></a></h2>
</a>
<p>En este último ejercicio se realizará una aplicación que permita hacer de <strong>wrapper</strong> de los distintos comandos empleados en Linux para el manejo de ficheros y directorios. La aplicación deberá permitir los siguientes comandos:</p>
<ol>
<li>Mostrar si es un directorio o un fichero.</li>
<li>Crear un nuevo directorio.</li>
<li>Listar los ficheros dentro de un directorio.</li>
<li>Mostrar el contenido de un fichero.</li>
<li>Borrar ficheros y directorios.</li>
<li>Mover ficheros y/o directorios de una ruta a otra.</li>
</ol>

<a href="#manejo-de-los-argumentos-2" id="manejo-de-los-argumentos-2" style="color: inherit; text-decoration: none;">
  <h3>Manejo de los argumentos<a name="id17"></a></h3>
</a>
<p>Como comentamos anteriormente, para poder acceder a los argumentos introducidos por el usuario desde la línea de comandos, se utilizará el paquete <strong>yargs</strong>.</p>
<p>En este caso, tendremos que crear varios comandos:</p>
<ul>
<li><code>type</code>: Este comando se encargará de mostrar si se trata de un directorio o un fichero.</li>
</ul>
<pre><code class="language-typescript"><span class="hl-0">yargs</span><span class="hl-1">.</span><span class="hl-2">command</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">command:</span><span class="hl-1"> </span><span class="hl-3">&#39;type&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Mostrar si es un directorio o un fichero&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">builder:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">path:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Ruta&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">demandOption:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">handler</span><span class="hl-0">:</span><span class="hl-1"> (</span><span class="hl-0">argv</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-4">typeof</span><span class="hl-1"> </span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1">!== </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Invalid path&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">type_</span><span class="hl-1">(</span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code></pre>
<ul>
<li><code>add</code>: Este comando se encargará de añadir un nuevo directorio.</li>
</ul>
<pre><code class="language-typescript"><span class="hl-0">yargs</span><span class="hl-1">.</span><span class="hl-2">command</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">command:</span><span class="hl-1"> </span><span class="hl-3">&#39;add&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Crear un nuevo directorio&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">builder:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">path:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Ruta del directorio&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">demandOption:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">handler</span><span class="hl-0">:</span><span class="hl-1"> (</span><span class="hl-0">argv</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-4">typeof</span><span class="hl-1"> </span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1">!== </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Invalid path&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">add</span><span class="hl-1">(</span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code></pre>
<ul>
<li><code>list</code>: Este comando se encargará de mostrar los directorios y ficheros que contiene.</li>
</ul>
<pre><code class="language-typescript"><span class="hl-0">yargs</span><span class="hl-1">.</span><span class="hl-2">command</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">command:</span><span class="hl-1"> </span><span class="hl-3">&#39;list&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Listar los ficheros dentro de un directorio&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">builder:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">path:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Ruta del directorio&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">demandOption:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">handler</span><span class="hl-0">:</span><span class="hl-1"> (</span><span class="hl-0">argv</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-4">typeof</span><span class="hl-1"> </span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1">!== </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Invalid path&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">list</span><span class="hl-1">(</span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code></pre>
<ul>
<li><code>show</code>: Este comando se encargará de mostrar el contenido de un fichero.</li>
</ul>
<pre><code class="language-typescript"><span class="hl-0">yargs</span><span class="hl-1">.</span><span class="hl-2">command</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">command:</span><span class="hl-1"> </span><span class="hl-3">&#39;show&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Mostrar el contenido de un fichero&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">builder:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">path:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Ruta del fichero&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">demandOption:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">handler</span><span class="hl-0">:</span><span class="hl-1"> (</span><span class="hl-0">argv</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-4">typeof</span><span class="hl-1"> </span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1"> !== </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Invalid user or path&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">showFile</span><span class="hl-1">(</span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code></pre>
<ul>
<li><code>remove</code>: Este comando se encargará de eliminar un directorio.</li>
</ul>
<pre><code class="language-typescript"><span class="hl-0">yargs</span><span class="hl-1">.</span><span class="hl-2">command</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">command:</span><span class="hl-1"> </span><span class="hl-3">&#39;remove&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Borrar ficheros y directorios&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">builder:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">path:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Ruta del directorio o del fichero&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">demandOption:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">handler</span><span class="hl-0">:</span><span class="hl-1"> (</span><span class="hl-0">argv</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-4">typeof</span><span class="hl-1"> </span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1">!== </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Invalid path&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">remove</span><span class="hl-1">(</span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code></pre>
<ul>
<li><code>move</code>: Este comando se encargará de mover un directorio.</li>
</ul>
<pre><code class="language-typescript"><span class="hl-0">yargs</span><span class="hl-1">.</span><span class="hl-2">command</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">command:</span><span class="hl-1"> </span><span class="hl-3">&#39;move&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Control de cambios sobre un directorio&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">builder:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">orig_path:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Ruta del directorio original&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">demandOption:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-0">dest_path:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">describe:</span><span class="hl-1"> </span><span class="hl-3">&#39;Ruta del directorio destino&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">demandOption:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">type:</span><span class="hl-1"> </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-2">handler</span><span class="hl-0">:</span><span class="hl-1"> (</span><span class="hl-0">argv</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-4">typeof</span><span class="hl-1"> </span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">orig_path</span><span class="hl-1"> !== </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1"> ||</span><br/><span class="hl-1">        </span><span class="hl-4">typeof</span><span class="hl-1"> </span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">dest_path</span><span class="hl-1"> !== </span><span class="hl-3">&#39;string&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Invalid user or path&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">moveDir</span><span class="hl-1">(</span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">orig_path</span><span class="hl-1">, </span><span class="hl-0">argv</span><span class="hl-1">.</span><span class="hl-0">dest_path</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">});</span>
</code></pre>

<a href="#método-type_" id="método-type_" style="color: inherit; text-decoration: none;">
  <h3>Método <code>type_()</code><a name="id18"></a></h3>
</a>
<p>Este método se encargará de mostrar si se trata de un directorio o un fichero, para ello primero tendrá que comprobar si la ruta introducida existe y, después, haciendo uso de la función isDirectory() se comprobará si es un directorio o un fichero.</p>
<pre><code class="language-typescript"><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-2">type_</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-2">existsSync</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">)) {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-2">isDirectory</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">)) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">path</span><span class="hl-4">}</span><span class="hl-3"> is a directory`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">path</span><span class="hl-4">}</span><span class="hl-3"> is a file`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Path not found&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#método-isdirectory" id="método-isdirectory" style="color: inherit; text-decoration: none;">
  <h3>Método <code>isDirectory()</code><a name="id19"></a></h3>
</a>
<p>Este método se encargará de comprobar si una ruta es un directorio.</p>
<pre><code class="language-typescript"><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-2">isDirectory</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-7">return</span><span class="hl-1"> </span><span class="hl-2">existsSync</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">) &amp;&amp; </span><span class="hl-2">statSync</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">).</span><span class="hl-2">isDirectory</span><span class="hl-1">();</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#método-add" id="método-add" style="color: inherit; text-decoration: none;">
  <h3>Método <code>add()</code><a name="id20"></a></h3>
</a>
<p>Este método se encargará de crear un nuevo directorio.</p>
<pre><code class="language-typescript"><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">dir</span><span class="hl-1"> = </span><span class="hl-0">path</span><span class="hl-1">.</span><span class="hl-2">split</span><span class="hl-1">(</span><span class="hl-3">&#39;/&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">dirName</span><span class="hl-1"> = </span><span class="hl-0">dir</span><span class="hl-1">[</span><span class="hl-0">dir</span><span class="hl-1">.</span><span class="hl-0">length</span><span class="hl-1"> - </span><span class="hl-10">1</span><span class="hl-1">];</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">dirPath</span><span class="hl-1"> = </span><span class="hl-0">path</span><span class="hl-1">.</span><span class="hl-2">substring</span><span class="hl-1">(</span><span class="hl-10">0</span><span class="hl-1">, </span><span class="hl-0">path</span><span class="hl-1">.</span><span class="hl-0">length</span><span class="hl-1"> - </span><span class="hl-0">dirName</span><span class="hl-1">.</span><span class="hl-0">length</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">dirExists</span><span class="hl-1"> = </span><span class="hl-2">existsSync</span><span class="hl-1">(</span><span class="hl-0">dirPath</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">dirExists</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">dirExists</span><span class="hl-1"> = </span><span class="hl-2">existsSync</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">dirExists</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Directory already exists&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">mkdirSync</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Directory created&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Invalid path&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#método-list" id="método-list" style="color: inherit; text-decoration: none;">
  <h3>Método <code>list()</code><a name="id21"></a></h3>
</a>
<p>Este método se encargará de mostrar los directorios y ficheros que contiene.</p>
<pre><code class="language-typescript"><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-2">list</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">dirExists</span><span class="hl-1"> = </span><span class="hl-2">existsSync</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">dirExists</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-2">readdir</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">, (</span><span class="hl-0">err</span><span class="hl-1">, </span><span class="hl-0">files</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">err</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Error reading directory&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">files</span><span class="hl-1">.</span><span class="hl-2">forEach</span><span class="hl-1">((</span><span class="hl-0">file</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-2">isDirectory</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-0">path</span><span class="hl-4">}</span><span class="hl-3">/</span><span class="hl-4">${</span><span class="hl-0">file</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">)) {</span><br/><span class="hl-1">            </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`[Directory]</span><span class="hl-9">\t</span><span class="hl-3"> </span><span class="hl-4">${</span><span class="hl-0">file</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">          } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`[File]</span><span class="hl-9">\t\t</span><span class="hl-3"> </span><span class="hl-4">${</span><span class="hl-0">file</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Invalid path&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#método-showfile" id="método-showfile" style="color: inherit; text-decoration: none;">
  <h3>Método <code>showFile()</code><a name="id22"></a></h3>
</a>
<p>Este método se encargará de mostrar el contenido de un fichero.</p>
<pre><code class="language-typescript"><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-2">showFile</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">open</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">, </span><span class="hl-3">&#39;r&#39;</span><span class="hl-1">, (</span><span class="hl-0">err</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">`Error opening </span><span class="hl-4">${</span><span class="hl-0">path</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-0">data</span><span class="hl-1"> = </span><span class="hl-3">&#39;&#39;</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">lineReader</span><span class="hl-1"> = </span><span class="hl-2">require</span><span class="hl-1">(</span><span class="hl-3">&#39;readline&#39;</span><span class="hl-1">).</span><span class="hl-2">createInterface</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-0">input:</span><span class="hl-1"> </span><span class="hl-2">require</span><span class="hl-1">(</span><span class="hl-3">&#39;fs&#39;</span><span class="hl-1">).</span><span class="hl-2">createReadStream</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">),</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-0">lineReader</span><span class="hl-1">.</span><span class="hl-2">on</span><span class="hl-1">(</span><span class="hl-3">&#39;line&#39;</span><span class="hl-1">, (</span><span class="hl-0">line</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">data</span><span class="hl-1"> += </span><span class="hl-0">line</span><span class="hl-1">;</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-0">lineReader</span><span class="hl-1">.</span><span class="hl-2">on</span><span class="hl-1">(</span><span class="hl-3">&#39;close&#39;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">` --&gt; Content of </span><span class="hl-4">${</span><span class="hl-0">path</span><span class="hl-4">}</span><span class="hl-3">:</span><span class="hl-9">\n</span><span class="hl-4">${</span><span class="hl-0">data</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#método-remove" id="método-remove" style="color: inherit; text-decoration: none;">
  <h3>Método <code>remove()</code><a name="id23"></a></h3>
</a>
<p>Este método se encargará de eliminar un directorio o un fichero.</p>
<pre><code class="language-typescript"><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-2">remove</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">dirExists</span><span class="hl-1"> = </span><span class="hl-2">existsSync</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">dirExists</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">dir</span><span class="hl-1"> = </span><span class="hl-0">path</span><span class="hl-1">.</span><span class="hl-2">split</span><span class="hl-1">(</span><span class="hl-3">&#39;/&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">dirName</span><span class="hl-1"> = </span><span class="hl-0">dir</span><span class="hl-1">[</span><span class="hl-0">dir</span><span class="hl-1">.</span><span class="hl-0">length</span><span class="hl-1"> - </span><span class="hl-10">1</span><span class="hl-1">];</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">dirPath</span><span class="hl-1"> = </span><span class="hl-0">path</span><span class="hl-1">.</span><span class="hl-2">substring</span><span class="hl-1">(</span><span class="hl-10">0</span><span class="hl-1">, </span><span class="hl-0">path</span><span class="hl-1">.</span><span class="hl-0">length</span><span class="hl-1"> - </span><span class="hl-0">dirName</span><span class="hl-1">.</span><span class="hl-0">length</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-6">dirExists</span><span class="hl-1"> = </span><span class="hl-2">existsSync</span><span class="hl-1">(</span><span class="hl-0">dirPath</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">dirExists</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">rmdirSync</span><span class="hl-1">(</span><span class="hl-0">path</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Directory removed&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Invalid path&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Invalid path&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#método-movedir" id="método-movedir" style="color: inherit; text-decoration: none;">
  <h3>Método <code>moveDir()</code><a name="id24"></a></h3>
</a>
<p>Este método se encargará de mover un directorio o un fichero de una ruta a otra.</p>
<pre><code class="language-typescript"><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-2">moveDir</span><span class="hl-1">(</span><span class="hl-0">oPath</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-0">dPath</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">access</span><span class="hl-1">(</span><span class="hl-0">oPath</span><span class="hl-1">, </span><span class="hl-0">constants</span><span class="hl-1">.</span><span class="hl-6">F_OK</span><span class="hl-1">, (</span><span class="hl-0">err</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">err</span><span class="hl-1">?.</span><span class="hl-0">code</span><span class="hl-1"> === </span><span class="hl-3">&#39;ENOENT&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Directory not found&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-0">err</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">access</span><span class="hl-1">(</span><span class="hl-0">dPath</span><span class="hl-1">, </span><span class="hl-0">constants</span><span class="hl-1">.</span><span class="hl-6">F_OK</span><span class="hl-1">, (</span><span class="hl-0">err</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">err</span><span class="hl-1">?.</span><span class="hl-0">code</span><span class="hl-1"> === </span><span class="hl-3">&#39;ENOENT&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-2">rename</span><span class="hl-1">(</span><span class="hl-0">oPath</span><span class="hl-1">, </span><span class="hl-0">dPath</span><span class="hl-1">, (</span><span class="hl-0">err</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">err</span><span class="hl-1">) {</span><br/><span class="hl-1">              </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-0">err</span><span class="hl-1">);</span><br/><span class="hl-1">            } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">              </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Directory moved&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">            }</span><br/><span class="hl-1">          });</span><br/><span class="hl-1">        } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-2">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Directory already exists&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#ejemplos-de-ejecución-2" id="ejemplos-de-ejecución-2" style="color: inherit; text-decoration: none;">
  <h3>Ejemplos de ejecución<a name="id25"></a></h3>
</a>
<pre><code class="language-bash"><span class="hl-1">$ node watch.js </span><span class="hl-2">type</span><span class="hl-1"> --path=path</span><br/><span class="hl-1">$ node watch.js add --path=path</span><br/><span class="hl-1">$ node watch.js list --path=path</span><br/><span class="hl-1">$ node watch.js show --path=path</span><br/><span class="hl-1">$ node watch.js remove --path=path</span><br/><span class="hl-1">$ node watch.js move --orig_path=path --dest_path=path</span>
</code></pre>
<p><strong>[IMAGEN]</strong></p>

<a href="#conclusión" id="conclusión" style="color: inherit; text-decoration: none;">
  <h1>CONCLUSIÓN<a name="id26"></a></h1>
</a>
<p>En conclusión, podemos comentar que gracias al paquete yargs podemos acceder y gestionar los parámetros de entrada de una forma muy sencilla, una cosa que es muy importante para poder realizar una aplicación de gran calidad para el usuario.</p>
<p>Por otro lado, gracias al uso de funciones asínronas, podemos realizar una gran cantidad de tareas en paralelo, lo que nos permite ahorrar tiempo y evitar errores, además de crear aplicaciones que nos permitan trabajar con directorios y ficheros de manera más sencilla.</p>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Modules</a></li><li class=" tsd-kind-module"><a href="modules/Ejercicio_02_Ejercicio_02.html">Ejercicio_<wbr/>02/<wbr/>Ejercicio_<wbr/>02</a></li><li class=" tsd-kind-module"><a href="modules/Ejercicio_03_Ejercicio_03.html">Ejercicio_<wbr/>03/<wbr/>Ejercicio_<wbr/>03</a></li><li class=" tsd-kind-module"><a href="modules/Ejercicio_03_Ejercicio_03_fs.html">Ejercicio_<wbr/>03/<wbr/>Ejercicio_<wbr/>03_<wbr/>fs</a></li><li class=" tsd-kind-module"><a href="modules/Ejercicio_04_Ejercicio_04.html">Ejercicio_<wbr/>04/<wbr/>Ejercicio_<wbr/>04</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>